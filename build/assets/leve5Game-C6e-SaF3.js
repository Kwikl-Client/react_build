var Y=Object.defineProperty;var K=(t,n,o)=>n in t?Y(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;var G=(t,n,o)=>K(t,typeof n!="symbol"?n+"":n,o);import{R as U,j as e,B as E,r as a,u as _,a as ee,c as V,P as te}from"./index-kZpWWiM3.js";class se extends U.Component{constructor(){super(...arguments);G(this,"state",{hasError:!1})}static getDerivedStateFromError(o){return console.error("ErrorBoundary caught an error:",o),{hasError:!0}}render(){return this.state.hasError?e.jsxs("div",{className:"text-center text-dark p-4",children:[e.jsx("h2",{children:"Something went wrong!"}),e.jsx("p",{children:"Please refresh the page or try again later."}),e.jsx(E,{variant:"primary",onClick:()=>window.location.reload(),children:"Refresh"})]}):this.props.children}}const ne=t=>{console.log("Generating quiz data for userType:",t);const o=[["Heart","Love","Compassion","Gratitude","Radiance"],["Mind","Clarity","Curiosity","Patience","Presence"],["Body","Joy","Creativity","Trust","Service"],["Soul","Peace","Wisdom","Supplication","Oneness"]].map((r,S)=>{const s=["XXXX","XXXX","XXXX","XXXX","XXXX"];let u,d,f;switch(t.toLowerCase()){case"reader":s[0]=r[0];break;case"member":s[0]=r[0],s[1]=r[1],s[2]=r[2];break;case"follower":s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3];break;case"star":s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[4]=r[4];break;default:s[0]=r[0]}switch(S){case 0:return u="Heart",d="Correct! Radiance returns to Heart.",f="Try again! Radiance Fades— Heart calls softly.",{question:s.join(" ➝ ")+" ➝ ?",options:["Heart","Mind"],correct:u,correctMessage:d,incorrectMessage:f};case 1:return u="Mind",d="Well done! Presence returns to Mind.",f="Try again! Presence wanders lost — Mind beckons clear.",{question:s.join(" ➝ ")+" ➝ ?",options:["Mind","Body"],correct:u,correctMessage:d,incorrectMessage:f};case 2:return u="Body",d="Yes! Service returns to Body.",f="Try again! Service withholds — Body breathes fully.",{question:s.join(" ➝ ")+" ➝ ?",options:["Body","Soul"],correct:u,correctMessage:d,incorrectMessage:f};case 3:return u="Soul",d="Exactly! Oneness returns to Soul.",f="Try again! Oneness flees briefly — Soul sings true.",{question:s.join(" ➝ ")+" ➝ ?",options:["Soul","Heart"],correct:u,correctMessage:d,incorrectMessage:f};default:return{}}});return console.log("Generated quizData:",o),o},oe=t=>{const n=t.slice();for(let o=n.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[n[o],n[r]]=[n[r],n[o]]}return n},W=["Excellent!","Wonderful!","Great Job!","Fantastic!"],A=(t,n)=>console.log(`Tracking event: ${t}, ${JSON.stringify(n)}`),ie=()=>{var z;const[t,n]=a.useState(0),[o,r]=a.useState([]),[S,s]=a.useState(!1),[u,d]=a.useState(!1),[f,I]=a.useState(!1),[X,N]=a.useState(""),[h,O]=a.useState(0),[H,P]=a.useState(0),[b,J]=a.useState([]),[B,w]=a.useState(!1),[y,Z]=a.useState(!1),[q,L]=a.useState(""),C=a.useRef(null),j=_(),{user:k}=ee(c=>c.auth),m=!!k,l=((z=k==null?void 0:k.customerType)==null?void 0:z.toLowerCase())||"reader",x=ne(l),F=o.length===x.length;console.log("isLoggedIn:",m,"userType:",l,"isGameEnabled:",y),console.log("Current question index:",t),console.log("Win condition:",F,"Answered questions:",o.length,"Total questions:",x.length),a.useEffect(()=>{console.log("Current question index updated to:",t)},[t]),a.useEffect(()=>{var g;console.log("Shuffling options for question index:",t);const c=((g=x[t])==null?void 0:g.options)||[],i=oe(c);console.log("Shuffled options:",i),J(i)},[t,l]),a.useEffect(()=>{if(h===H)return;const c=Math.ceil((h-H)/10),i=setInterval(()=>{P(g=>{const p=g+c;return p>=h?(clearInterval(i),h):p})},50);return()=>clearInterval(i)},[h,H]),a.useEffect(()=>{let c;if(F&&C.current){console.log("Triggering win confetti");const i=V.create(C.current,{resize:!0,useWorker:!0}),p=Date.now()+5e3,v=["#FF4500","#00FF00","#1E90FF"],M=()=>{i({particleCount:5,angle:60,spread:55,origin:{x:0,y:.6},colors:v}),i({particleCount:5,angle:120,spread:55,origin:{x:1,y:.6},colors:v}),Date.now()<p&&(c=requestAnimationFrame(M))};M(),setTimeout(()=>{console.log("Game completed, navigating to /plus-one-form"),A("Level5Game-Completed",{userType:l,score:h}),j("/plus-one-form")},2500)}return()=>{c&&cancelAnimationFrame(c),V.reset()}},[F,j,l,h]);const R=c=>{if(!m||l!=="star"||!y){console.log("Option click ignored:",{isLoggedIn:m,userType:l,isGameEnabled:y}),L("Only +1 Host users can play this game. Please upgrade your account.");return}w(!0);const i=x[t];if(console.log("Selected option:",c,"Correct answer:",i.correct),c===i.correct){if(r([...o,i]),O(p=>p+100),N(i.correctMessage||W[Math.floor(Math.random()*W.length)]),I(!0),C.current){const p=V.create(C.current,{resize:!0,useWorker:!0}),v=2e3,M=Date.now()+v,$=["#FF4500","#00FF00","#1E90FF"];let T;const D=()=>{p({particleCount:5,spread:70,origin:{x:.5,y:.5},colors:$,ticks:200}),Date.now()<M&&(T=requestAnimationFrame(D))};D(),setTimeout(()=>{T&&cancelAnimationFrame(T),p.reset()},v)}const g=t+1;g<x.length?setTimeout(()=>{I(!1),n(g),w(!1)},2500):setTimeout(()=>{I(!1),w(!1)},2500)}else console.log("Incorrect answer selected"),s(!0),d(!0),N(i.incorrectMessage||"Try again!"),setTimeout(()=>{s(!1),d(!1),w(!1)},2e3)},Q=()=>{console.log("handleJoinClick: isLoggedIn=",m,"userType=",l),m?l==="star"?(Z(!0),A("Level5Game-Join-Click",{isLoggedIn:!0,userType:l,gameEnabled:!0})):(L("Only +1 Host users can play this game. Please upgrade your account."),A("Level5Game-Join-Click",{isLoggedIn:!0,userType:l,error:"Non-STAR user attempted to play"})):(j("/"),A("Level5Game-Join-Click",{isLoggedIn:!1}))};return e.jsx(se,{children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",style:{flexDirection:"column"},children:[e.jsx("canvas",{ref:C,className:"confetti-canvas"}),e.jsxs("div",{className:"purple-card",children:[e.jsx("img",{src:te,style:{width:"30%",height:"30%",position:"absolute",left:"-7%",top:"-10%"}}),F?e.jsx("div",{className:"fade-in text-center",children:e.jsx("h2",{className:"mb-4 fw-bold text-white",style:{fontSize:"20px",fontFamily:"'Aboreto', sans-serif"},children:"Congratulations on being a successful host"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"animate-top",children:[e.jsxs("h2",{style:{fontSize:"1rem",color:"white",fontFamily:"'Aboreto', sans-serif"},children:["Question ",t+1," of ",x.length]}),e.jsx("div",{className:"mt-2 text-white",style:{padding:"40px",fontSize:"1.5rem",fontFamily:"'Aboreto', sans-serif",fontWeight:"600"},children:x[t].question})]})},t),f&&e.jsx("div",{className:"achievement-effect bounce",style:{fontFamily:"'Aboreto', sans-serif"},children:X}),u&&m&&e.jsx("div",{className:"fade-in",style:{color:"red",fontSize:"20px",textAlign:"center",fontFamily:"'Aboreto', sans-serif"},children:X}),e.jsx("div",{className:"options-container",style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"20px",marginBottom:"20px"},children:y&&m&&l==="star"?e.jsxs(e.Fragment,{children:[e.jsx(E,{id:"option3",variant:"light",className:`option-button ${S?"shake":""}`,onClick:()=>R(b[0]),disabled:B,style:{width:"45%",padding:"40px",fontSize:"20px",fontWeight:"600",borderRadius:"8px",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#e5e5e5",border:"4px solid #ffcc00"},children:b[0]}),e.jsx(E,{id:"option2",variant:"light",className:`option-button ${S?"shake":""}`,onClick:()=>R(b[1]),disabled:B,style:{width:"45%",padding:"40px",fontSize:"20px",fontWeight:"600",borderRadius:"8px",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#e5e5e5",border:"4px solid #ffcc00"},children:b[1]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>j("/"),style:{width:"45%",height:"100px",borderRadius:"8px",backgroundColor:"#e5e5e5",animation:"pulse 2s infinite",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#333",cursor:"pointer"},children:[e.jsx("style",{children:`
                                                    @keyframes pulse {
                                                        0% { transform: scale(1); opacity: 0.9; }
                                                        50% { transform: scale(1.02); opacity: 1; }
                                                        100% { transform: scale(1); opacity: 0.9; }
                                                    }
                                                `}),e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",style:{marginBottom:"8px"},children:[e.jsx("path",{d:"M16 10C16 8.93913 15.5786 7.92172 14.8284 7.17157C14.0783 6.42143 13.0609 6 12 6C10.9391 6 9.92172 6.42143 9.17157 7.17157C8.42143 7.92172 8 8.93913 8 10V11H7V10C7 8.67392 7.52678 7.40215 8.46447 6.46447C9.40215 5.52678 10.6739 5 12 5C13.3261 5 14.5979 5.52678 15.5355 6.46447C16.4732 7.40215 17 8.67392 17 10V11H16V10Z",fill:"#333"}),e.jsx("path",{d:"M19 11H5C4.73478 11 4.48043 11.1054 4.29289 11.2929C4.10536 11.4804 4 11.7348 4 12V20C4 20.2652 4.10536 20.5196 4.29289 20.7071C4.48043 20.8946 4.73478 21 5 21H19C19.2652 21 19.5196 20.8946 19.7071 20.7071C19.8946 20.5196 20 20.2652 20 20V12C20 11.7348 19.8946 11.4804 19.7071 11.2929C19.5196 11.1054 19.2652 11 19 11ZM5 12H19V20H5V12Z",fill:"#333"}),e.jsx("path",{d:"M12 14C12.5523 14 13 14.4477 13 15V17C13 17.5523 12.5523 18 12 18C11.4477 18 11 17.5523 11 17V15C11 14.4477 11.4477 14 12 14Z",fill:"#333"})]})]}),e.jsxs("div",{onClick:()=>j("/"),style:{width:"45%",height:"100px",borderRadius:"8px",backgroundColor:"#e5e5e5",animation:"pulse 2s infinite",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#333",cursor:"pointer"},children:[e.jsx("style",{children:`
                                                    @keyframes pulse {
                                                        0% { transform: scale(1); opacity: 0.9; }
                                                        50% { transform: scale(1.02); opacity: 1; }
                                                        100% { transform: scale(1); opacity: 0.9; }
                                                    }
                                                `}),e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",style:{marginBottom:"8px"},children:[e.jsx("path",{d:"M16 10C16 8.93913 15.5786 7.92172 14.8284 7.17157C14.0783 6.42143 13.0609 6 12 6C10.9391 6 9.92172 6.42143 9.17157 7.17157C8.42143 7.92172 8 8.93913 8 10V11H7V10C7 8.67392 7.52678 7.40215 8.46447 6.46447C9.40215 5.52678 10.6739 5 12 5C13.3261 5 14.5979 5.52678 15.5355 6.46447C16.4732 7.40215 17 8.67392 17 10V11H16V10Z",fill:"#333"}),e.jsx("path",{d:"M19 11H5C4.73478 11 4.48043 11.1054 4.29289 11.2929C4.10536 11.4804 4 11.7348 4 12V20C4 20.2652 4.10536 20.5196 4.29289 20.7071C4.48043 20.8946 4.73478 21 5 21H19C19.2652 21 19.5196 20.8946 19.7071 20.7071C19.8946 20.5196 20 20.2652 20 20V12C20 11.7348 19.8946 11.4804 19.7071 11.2929C19.5196 11.1054 19.2652 11 19 11ZM5 12H19V20H5V12Z",fill:"#333"}),e.jsx("path",{d:"M12 14C12.5523 14 13 14.4477 13 15V17C13 17.5523 12.5523 18 12 18C11.4477 18 11 17.5523 11 17V15C11 14.4477 11.4477 14 12 14Z",fill:"#333"})]})]})]})})]})]}),!y&&e.jsxs("form",{style:{width:"100%",maxWidth:"500px",marginTop:"20px"},children:[e.jsx(E,{className:"w-100 mb-30",onClick:Q,style:{cursor:"pointer",backgroundColor:"#d22f26",color:"white",width:"auto",borderRadius:"5px",padding:"10px 20px",boxShadow:"rgba(75, 76, 78, 0.3) 0px 6px 24px",display:"inline-block"},children:"Yes — Activate My +1 Host"}),q&&e.jsx("div",{className:"error",style:{color:"red",marginTop:"8px",fontSize:"14px",textAlign:"center",marginBottom:"30px"},children:q})]})]})})};export{ie as default};
